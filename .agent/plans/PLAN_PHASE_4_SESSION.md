# ğŸ•’ Phase 4: ì„¸ì…˜ ë° ë³´ì•ˆ ê´€ë¦¬ ê³„íš (Session & Security)

> **ëª©í‘œ**: ì„¸ì…˜ ë³´ì•ˆ ê°•í™”(1ì‹œê°„ íƒ€ì„ì•„ì›ƒ) ë° ë°ì´í„° ìˆ˜ëª… ì£¼ê¸° ê´€ë¦¬(10ì¼ íŒŒì¼ ë³´ê´€).

## ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 1. ì„¸ì…˜ ê´€ë¦¬ (Session Management)

- [x] **ë¯¸ë“¤ì›¨ì–´ (Middleware)**:
  - ì ˆëŒ€ì  ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ ì ìš© (1ì‹œê°„)
  - ì¿ í‚¤/ë©”íƒ€ë°ì´í„°ì˜ `last_active` íƒ€ì„ìŠ¤íƒ¬í”„ í™•ì¸
  - 1ì‹œê°„ ì´ˆê³¼ ì‹œ ê°•ì œ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
- [x] **í´ë¼ì´ì–¸íŠ¸ (Client-side)**:
  - **ìë™ ì €ì¥ (AutoSave)**: (ì¶”í›„ êµ¬í˜„ ì˜ˆì •)
  - **ë¹„í™œë™ íƒ€ì´ë¨¸**: ë§ˆìš°ìŠ¤/í‚¤ë³´ë“œ ì…ë ¥ì´ 59ë¶„ê°„ ì—†ì„ ê²½ìš° ê²½ê³  í‘œì‹œ -> 60ë¶„ ì‹œ ìë™ ë¡œê·¸ì•„ì›ƒ

### 2. íŒŒì¼ ë³´ê´€ ì •ì±… (10 Days Retention)

- [ ] **ìŠ¤í† ë¦¬ì§€ ë¡œì§**:
  - `translated_files` ë²„í‚· ëŒ€ìƒ
- [x] **í‘œì‹œ ë¡œì§ (`My History`)**:
  - ìƒì„±ì¼ < 10ì¼: "ë‹¤ìš´ë¡œë“œ" ë²„íŠ¼ í™œì„±í™”
  - ìƒì„±ì¼ > 10ì¼: "ë§Œë£Œë¨(Expired)" í‘œì‹œ (ë‹¤ìš´ë¡œë“œ ë¶ˆê°€)
- [ ] **ì •ë¦¬ ì‘ì—… (Cleanup Job)**:
  - **ì˜µì…˜ A (pg_cron)**: `DELETE FROM storage.objects WHERE bucket_id = 'translated_files' AND created_at < NOW() - INTERVAL '10 days';`
  - **ì˜µì…˜ B (Edge Function)**: ìŠ¤ì¼€ì¤„ë§ í•¨ìˆ˜ë¡œ ì •ë¦¬
  - _ê²°ì •_: Supabase ìš”ê¸ˆì œ ì§€ì› ì‹œ `pg_cron` ì‚¬ìš©, ì•„ë‹ˆë©´ Edge Function íŠ¸ë¦¬ê±°.

### 3. "ì‘ì—… ì €ì¥" ë¡œì§ (Work Saving)

- [ ] **ì´ˆì•ˆ(Drafts) ì‹œìŠ¤í…œ**:
  - ì‚¬ìš©ìê°€ ì‘ì—… ì¤‘ì¼ ë•Œ `translation_jobs` ìƒíƒœë¥¼ `DRAFT` ë˜ëŠ” `PROCESSING`ìœ¼ë¡œ ìœ ì§€
  - 1ì‹œê°„ í›„ ë¡œê·¸ì•„ì›ƒ ë˜ë”ë¼ë„, ì¬ë¡œê·¸ì¸ ì‹œ "ì¤‘ë‹¨ëœ ì‘ì—…ì´ ìˆìŠµë‹ˆë‹¤" ì•Œë¦¼ ë° "ì´ì–´í•˜ê¸°" ì œê³µ

## ğŸ§ª ê²€ì¦ (Verification)

- [ ] ë¡œê·¸ì¸ í›„ 61ë¶„ ëŒ€ê¸° -> ìë™ ë¡œê·¸ì•„ì›ƒ í™•ì¸
- [ ] íŒŒì¼ ì—…ë¡œë“œ í›„ "10ì¼ í›„ ë§Œë£Œ" ë¼ë²¨ í™•ì¸
- [ ] DBì—ì„œ ë‚ ì§œë¥¼ 11ì¼ ì „ìœ¼ë¡œ ì¡°ì‘ -> ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ë¹„í™œì„±í™” í™•ì¸
